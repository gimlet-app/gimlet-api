
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Gimlet v1 API Reference</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen-c9d8fa83.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-953e3353.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-a9fde460.js"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
  </head>

  <body class="index" data-languages="[&quot;ruby&quot;,&quot;php&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-0784ec86.png" class="logo" alt="" />
        <div class="lang-selector">
              <a href="#" data-language-name="ruby">ruby</a>
              <a href="#" data-language-name="php">php</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#rest-api" class="toc-h1 toc-link" data-title="REST API">REST API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#introduction" class="toc-h2 toc-link" data-title="Introduction">Introduction</a>
                  </li>
                  <li>
                    <a href="#getting-help" class="toc-h2 toc-link" data-title="Getting help">Getting help</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#authentication" class="toc-h1 toc-link" data-title="Authentication">Authentication</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#api-key-required" class="toc-h2 toc-link" data-title="API Key Required">API Key Required</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#questions" class="toc-h1 toc-link" data-title="Questions">Questions</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#list-questions-json" class="toc-h2 toc-link" data-title="List Questions JSON">List Questions JSON</a>
                  </li>
                  <li>
                    <a href="#list-questions-csv" class="toc-h2 toc-link" data-title="List Questions CSV">List Questions CSV</a>
                  </li>
                  <li>
                    <a href="#add-question" class="toc-h2 toc-link" data-title="Add Question">Add Question</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#branches" class="toc-h1 toc-link" data-title="Branches">Branches</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#list-branches-json" class="toc-h2 toc-link" data-title="List Branches JSON">List Branches JSON</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#facets" class="toc-h1 toc-link" data-title="Facets">Facets</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#list-facets-json" class="toc-h2 toc-link" data-title="List Facets JSON">List Facets JSON</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#users" class="toc-h1 toc-link" data-title="Users">Users</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#list-users-json" class="toc-h2 toc-link" data-title="List Users JSON">List Users JSON</a>
                  </li>
                  <li>
                    <a href="#add-user" class="toc-h2 toc-link" data-title="Add User">Add User</a>
                  </li>
                  <li>
                    <a href="#update-user" class="toc-h2 toc-link" data-title="Update User">Update User</a>
                  </li>
                  <li>
                    <a href="#delete-user" class="toc-h2 toc-link" data-title="Delete User">Delete User</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://github.com/slatedocs/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='rest-api'>REST API</h1><h2 id='introduction'>Introduction</h2>
<p>Welcome to the <a href="https://gimlet.us">Gimlet</a> REST API. You can use our API to access Gimlet API endpoints, which can get information on questions, branches, facets, and users from your account in our database.</p>

<p>We have language examples for both Ruby and PHP. You can view the code examples in the dark area to the right, and you can switch the programming language of the examples with the tabs in the top right.</p>
<h2 id='getting-help'>Getting help</h2>
<p>If this guide isn&#39;t enough for you, please create a support ticket by contacting us at <a href="mailto:support@gimlet.us">support@gimlet.us</a> and we&#39;ll give you a hand.</p>
<h1 id='authentication'>Authentication</h1><h2 id='api-key-required'>API Key Required</h2>
<p>To get an API key, have an account administrator head to:</p>

<p>Account -&gt; Branches -&gt; Users -&gt; (Choose an Email)</p>

<p>and click the &quot;Generate API Key&quot; button.</p>

<p>The API key grants a user access to add and query questions for sites they are a member of. Gimlet requires the API key to be included in all API requests to the server.</p>
<div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="c1"># Create a file named vars.rb for your API calls</span>
<span class="c1">#</span>
<span class="c1"># Required API Variables</span>
<span class="no">DOMAIN</span>  <span class="o">=</span> <span class="s1">'your_domain'</span> <span class="c1"># Without .gimlet.us</span>
<span class="no">EMAIL</span>   <span class="o">=</span> <span class="s1">'your_email_address'</span>
<span class="no">API_KEY</span> <span class="o">=</span> <span class="s1">'your_api_key'</span>
<span class="no">SITE_ID</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># Get this integer from listing branches, or looking at the URL in the new question form</span>

</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="c1">// Create a file named vars.php for your API calls</span>
<span class="nv">$DOMAIN</span> <span class="o">=</span> <span class="s2">"&lt;your_gimlet_domain&gt;"</span><span class="p">;</span>  <span class="c1">// Without .gimlet.us</span>
<span class="nv">$EMAIL</span> <span class="o">=</span> <span class="s2">"&lt;your_email&gt;"</span><span class="p">;</span>
<span class="nv">$API_KEY</span> <span class="o">=</span> <span class="s2">"&lt;your_api_key&gt;"</span><span class="p">;</span>
<span class="nv">$SITE_ID</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>  <span class="c1">// Get this integer from listing branches, or looking at the URL in the new question form</span>
<span class="cp">?&gt;</span>

</code></pre></div>
<aside class="success">
Remember â€” You need an API key to access your data!
</aside>
<h1 id='questions'>Questions</h1><h2 id='list-questions-json'>List Questions JSON</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'date'</span>
<span class="nb">require</span> <span class="s1">'faraday'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="c1">#</span>
<span class="c1"># List all Questions from a Branch/Site for the past 30 days as JSON</span>
<span class="c1">#</span>

<span class="c1"># Required API Variables</span>
<span class="nb">require</span> <span class="s1">'./vars.rb'</span>

<span class="c1"># Report Dates</span>
<span class="n">today</span> <span class="o">=</span> <span class="no">Date</span><span class="p">.</span><span class="nf">today</span>
<span class="n">thirty_days_ago</span> <span class="o">=</span> <span class="n">today</span> <span class="o">-</span> <span class="mi">30</span>

<span class="c1"># URL and Path</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">"https://</span><span class="si">#{</span><span class="no">DOMAIN</span><span class="si">}</span><span class="s2">.gimlet.us"</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">"/api/v1/sites/</span><span class="si">#{</span><span class="no">SITE_ID</span><span class="si">}</span><span class="s2">/questions.json?start_date=</span><span class="si">#{</span><span class="n">thirty_days_ago</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">&amp;end_date=</span><span class="si">#{</span><span class="n">today</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">"</span>

<span class="c1"># New connection with base URL and path</span>
<span class="n">conn</span> <span class="o">=</span> <span class="no">Faraday</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">url: </span><span class="n">url</span><span class="p">)</span>    <span class="c1"># New connection with base URL</span>
<span class="n">conn</span><span class="p">.</span><span class="nf">basic_auth</span><span class="p">(</span><span class="no">EMAIL</span><span class="p">,</span> <span class="no">API_KEY</span><span class="p">)</span> <span class="c1"># Set the authentication header</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>       <span class="c1"># GET API request</span>

<span class="c1"># Print the results</span>
<span class="n">results</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="nb">puts</span> <span class="s2">"RESULTS: </span><span class="si">#{</span><span class="n">results</span><span class="p">.</span><span class="nf">inspect</span><span class="si">}</span><span class="s2">"</span>

</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vars.php'</span><span class="p">;</span>

<span class="nv">$thirty_days_ago</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'Y-m-d'</span><span class="p">,</span> <span class="nb">strtotime</span><span class="p">(</span><span class="s1">'-30 days'</span><span class="p">));</span>
<span class="nv">$today</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'Y-m-d'</span><span class="p">);</span>

<span class="nv">$api_url</span> <span class="o">=</span> <span class="s2">"https://${DOMAIN}.gimlet.us/api/v1/sites/${SITE_ID}/questions?start_date=${thirty_days_ago}&amp;end_date=${today}"</span><span class="p">;</span>

<span class="nv">$req</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="nv">$api_url</span><span class="p">);</span>
<span class="nv">$credentials</span> <span class="o">=</span> <span class="s2">"${EMAIL}:${API_KEY}"</span><span class="p">;</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_USERPWD</span><span class="p">,</span> <span class="nv">$credentials</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$req</span><span class="p">);</span>
<span class="nv">$parsed</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>

<span class="c1">// Do what you need with the data</span>
<span class="nb">var_dump</span><span class="p">(</span><span class="nv">$parsed</span><span class="p">);</span>
<span class="c1">// ?&gt;</span>
</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"questions"</span><span class="p">:</span><span class="w">
  </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"question_number"</span><span class="p">:</span><span class="w"> </span><span class="mi">801</span><span class="p">,</span><span class="w">
      </span><span class="nl">"initials"</span><span class="p">:</span><span class="w"> </span><span class="s2">"test"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jane@library.org"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Reference"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"duration"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0-5 minutes"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Phone"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"asked_by"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Staff"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"question_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Technology"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"difficulty"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nl">"asked_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-03-24 10:42:00 AM"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"question_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-03-24"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"question_time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10:42:00 AM"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"question_half_hour"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10:30:00 AM"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"question_weekday"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Wednesday"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"added_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-03-24 10:42:32 AM"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"tags"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example_tag"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"site"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Humanities Library"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"account"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Big Campus"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test at 10:42 AM!"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test question."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="err">...</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves all questions as JSON.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET https://&lt;DOMAIN&gt;.gimlet.us/api/v1/sites/&lt;SITE_ID&gt;/questions.json</code></p>
<h3 id='query-parameters'>Query Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>start_date</td>
<td>null</td>
<td>YYYY-MM-DD</td>
</tr>
<tr>
<td>end_date</td>
<td>null</td>
<td>YYYY-MM-DD</td>
</tr>
</tbody></table>
<h2 id='list-questions-csv'>List Questions CSV</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'csv'</span>
<span class="nb">require</span> <span class="s1">'date'</span>
<span class="nb">require</span> <span class="s1">'faraday'</span>

<span class="c1">#</span>
<span class="c1"># List all Questions from a Branch/Site for the past 30 days as CSV</span>
<span class="c1">#</span>

<span class="c1"># Required API Variables</span>
<span class="nb">require</span> <span class="s1">'./vars.rb'</span>

<span class="c1"># Report Dates</span>
<span class="n">today</span> <span class="o">=</span> <span class="no">Date</span><span class="p">.</span><span class="nf">today</span>
<span class="n">thirty_days_ago</span> <span class="o">=</span> <span class="n">today</span> <span class="o">-</span> <span class="mi">30</span>

<span class="c1"># URL and Path</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">"https://</span><span class="si">#{</span><span class="no">DOMAIN</span><span class="si">}</span><span class="s2">.gimlet.us"</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">"/api/v1/sites/</span><span class="si">#{</span><span class="no">SITE_ID</span><span class="si">}</span><span class="s2">/questions.csv?start_date=</span><span class="si">#{</span><span class="n">thirty_days_ago</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">&amp;end_date=</span><span class="si">#{</span><span class="n">today</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">"</span>

<span class="c1"># New connection with base URL, path, and accepting CSV</span>
<span class="n">conn</span> <span class="o">=</span> <span class="no">Faraday</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">url: </span><span class="n">url</span><span class="p">,</span> <span class="ss">headers: </span><span class="p">{</span><span class="s1">'Accept'</span><span class="p">:</span> <span class="s1">'text/csv'</span><span class="p">})</span>
<span class="n">conn</span><span class="p">.</span><span class="nf">basic_auth</span><span class="p">(</span><span class="no">EMAIL</span><span class="p">,</span> <span class="no">API_KEY</span><span class="p">)</span> <span class="c1"># Set the authentication header</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>       <span class="c1"># GET API request</span>

<span class="c1"># Print the results</span>
<span class="n">results</span> <span class="o">=</span> <span class="no">CSV</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="nb">puts</span> <span class="s2">"RESULTS: </span><span class="si">#{</span><span class="n">results</span><span class="p">.</span><span class="nf">inspect</span><span class="si">}</span><span class="s2">"</span>

</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vars.php'</span><span class="p">;</span>

<span class="nv">$thirty_days_ago</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'Y-m-d'</span><span class="p">,</span> <span class="nb">strtotime</span><span class="p">(</span><span class="s1">'-30 days'</span><span class="p">));</span>
<span class="nv">$today</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'Y-m-d'</span><span class="p">);</span>

<span class="nv">$api_url</span> <span class="o">=</span> <span class="s2">"https://${DOMAIN}.gimlet.us/api/v1/sites/${SITE_ID}/questions?start_date=${thirty_days_ago}&amp;end_date=${today}"</span><span class="p">;</span>

<span class="nv">$req</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="nv">$api_url</span><span class="p">);</span>
<span class="nv">$credentials</span> <span class="o">=</span> <span class="s2">"${EMAIL}:${API_KEY}"</span><span class="p">;</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_USERPWD</span><span class="p">,</span> <span class="nv">$credentials</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_HTTPHEADER</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">'Accept: text/csv'</span><span class="p">));</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$req</span><span class="p">);</span>

<span class="k">echo</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre></div>
<blockquote>
<p>The above command returns CSV structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext"><code>[["800", "test", "jane@library.org", "Reference", "0-5 minutes", "Phone", "Staff", "Technology", nil, "2021-03-24 10:40:00 AM", "2021-03-24", "10:40:00 AM", "10:30:00 AM", "Wednesday", "2021-03-24 10:40:28 AM", "example_tag", "Humanities Library", "Big Campus", "Test at 10:40 AM!", "Another test!"], ["801", "test", "jane@library.org", "Reference", "0-5 minutes", "Phone", "Staff", "Technology", nil, "2021-03-24 10:42:00 AM", "2021-03-24", "10:42:00 AM", "10:30:00 AM", "Wednesday", "2021-03-24 10:42:32 AM", "example_tag", "Humanities Library", "Big Campus", "Test at 10:42 AM!", "Another test!"][...]]
</code></pre></div>
<p>This endpoint retrieves all account questions as CSV.</p>
<h3 id='http-request-2'>HTTP Request</h3>
<p><code>GET https://&lt;DOMAIN&gt;.gimlet.us/api/v1/sites/&lt;SITE_ID&gt;/questions.csv</code></p>
<h3 id='query-parameters-2'>Query Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>start_date</td>
<td>null</td>
<td>YYYY-MM-DD</td>
</tr>
<tr>
<td>end_date</td>
<td>null</td>
<td>YYYY-MM-DD</td>
</tr>
</tbody></table>
<h2 id='add-question'>Add Question</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'date'</span>
<span class="nb">require</span> <span class="s1">'faraday'</span>

<span class="c1">#</span>
<span class="c1"># Add a Question to a Branch/Site</span>
<span class="c1">#</span>

<span class="c1"># Required API Variables</span>
<span class="nb">require</span> <span class="s1">'./vars.rb'</span>

<span class="c1"># URL and Path</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">"https://</span><span class="si">#{</span><span class="no">DOMAIN</span><span class="si">}</span><span class="s2">.gimlet.us"</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">"/api/v1/sites/</span><span class="si">#{</span><span class="no">SITE_ID</span><span class="si">}</span><span class="s2">/questions"</span>

<span class="n">date_time</span> <span class="o">=</span> <span class="no">DateTime</span><span class="p">.</span><span class="nf">now</span>

<span class="c1"># Field values</span>
<span class="n">fields</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">fields</span><span class="p">[</span><span class="s2">"site_id"</span><span class="p">]</span> <span class="o">=</span> <span class="no">SITE_ID</span>
<span class="n">fields</span><span class="p">[</span><span class="s2">"question"</span><span class="p">]</span><span class="o">=</span> <span class="p">{}</span>
<span class="n">fields</span><span class="p">[</span><span class="s2">"question"</span><span class="p">][</span><span class="s2">"location_name"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Reference"</span>
<span class="n">fields</span><span class="p">[</span><span class="s2">"question"</span><span class="p">][</span><span class="s2">"duration_name"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"0-5 minutes"</span>
<span class="n">fields</span><span class="p">[</span><span class="s2">"question"</span><span class="p">][</span><span class="s2">"format_name"</span><span class="p">]</span>   <span class="o">=</span> <span class="s2">"Phone"</span>
<span class="n">fields</span><span class="p">[</span><span class="s2">"question"</span><span class="p">][</span><span class="s2">"questioner_name"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Staff"</span>
<span class="n">fields</span><span class="p">[</span><span class="s2">"question"</span><span class="p">][</span><span class="s2">"question_type_name"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Technology"</span>
<span class="n">fields</span><span class="p">[</span><span class="s2">"question"</span><span class="p">][</span><span class="s2">"difficulty_name"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"1"</span>
<span class="n">fields</span><span class="p">[</span><span class="s2">"question"</span><span class="p">][</span><span class="s2">"tag_list"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"example_tag"</span>
<span class="n">fields</span><span class="p">[</span><span class="s2">"question"</span><span class="p">][</span><span class="s2">"question"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Test at </span><span class="si">#{</span><span class="no">Time</span><span class="p">.</span><span class="nf">now</span><span class="p">.</span><span class="nf">strftime</span><span class="p">(</span><span class="s2">"%I:%M %p"</span><span class="p">)</span><span class="si">}</span><span class="s2">!"</span>
<span class="n">fields</span><span class="p">[</span><span class="s2">"question"</span><span class="p">][</span><span class="s2">"answer"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"Another test!"</span>
<span class="n">fields</span><span class="p">[</span><span class="s2">"question"</span><span class="p">][</span><span class="s2">"initials"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"test"</span>
<span class="n">fields</span><span class="p">[</span><span class="s2">"question"</span><span class="p">][</span><span class="s2">"asked_at_time"</span><span class="p">]</span> <span class="o">=</span> <span class="n">date_time</span><span class="p">.</span><span class="nf">strftime</span><span class="p">(</span><span class="s2">"%I:%M %p"</span><span class="p">)</span>
<span class="n">fields</span><span class="p">[</span><span class="s2">"question"</span><span class="p">][</span><span class="s2">"asked_at_date"</span><span class="p">]</span> <span class="o">=</span> <span class="n">date_time</span><span class="p">.</span><span class="nf">strftime</span><span class="p">(</span><span class="s2">"%m/%d/%Y"</span><span class="p">)</span>

<span class="c1"># New connection with base URL and path</span>
<span class="n">conn</span> <span class="o">=</span> <span class="no">Faraday</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">url: </span><span class="n">url</span><span class="p">)</span>        <span class="c1"># New connection with base URL</span>
<span class="n">conn</span><span class="p">.</span><span class="nf">basic_auth</span><span class="p">(</span><span class="no">EMAIL</span><span class="p">,</span> <span class="no">API_KEY</span><span class="p">)</span>     <span class="c1"># Set the authentication header</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>  <span class="c1"># POST API request</span>

<span class="c1"># Print the results</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="nf">body</span>
<span class="nb">puts</span> <span class="s2">"RESULTS: </span><span class="si">#{</span><span class="n">results</span><span class="p">.</span><span class="nf">inspect</span><span class="si">}</span><span class="s2">"</span>

</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vars.php'</span><span class="p">;</span>

<span class="nv">$api_url</span> <span class="o">=</span> <span class="s2">"https://${DOMAIN}.gimlet.us/api/v1/sites/${SITE_ID}/questions"</span><span class="p">;</span>

<span class="nv">$now_time</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'G:i'</span><span class="p">);</span>
<span class="nv">$now_date</span> <span class="o">=</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'m/d/Y'</span><span class="p">);</span>

<span class="c1">// Change these to be what you actually need!</span>
<span class="nv">$fields</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">"site_id"</span> <span class="o">=&gt;</span> <span class="nv">$SITE_ID</span><span class="p">,</span>
    <span class="s2">"question[location_name]"</span> <span class="o">=&gt;</span> <span class="s2">"Reception desk"</span><span class="p">,</span>
    <span class="s2">"question[duration_name]"</span> <span class="o">=&gt;</span> <span class="s2">"0-9 minutes"</span><span class="p">,</span>
    <span class="s2">"question[format_name]"</span> <span class="o">=&gt;</span> <span class="s2">"Phone"</span><span class="p">,</span>
    <span class="s2">"question[questioner_name]"</span> <span class="o">=&gt;</span> <span class="s2">"Staff"</span><span class="p">,</span>
    <span class="s2">"question[question_type_name]"</span> <span class="o">=&gt;</span> <span class="s2">"Administrative"</span><span class="p">,</span>
    <span class="s2">"question[difficulty_name]"</span> <span class="o">=&gt;</span> <span class="s2">"1"</span><span class="p">,</span>
    <span class="s2">"question[tag_list]"</span> <span class="o">=&gt;</span> <span class="s2">""</span><span class="p">,</span>
    <span class="s2">"question[question]"</span> <span class="o">=&gt;</span> <span class="s2">"Test at ${now_time}!"</span><span class="p">,</span>
    <span class="s2">"question[answer]"</span> <span class="o">=&gt;</span> <span class="s2">"Another test!"</span><span class="p">,</span>
    <span class="s2">"question[initials]"</span> <span class="o">=&gt;</span> <span class="s2">"test"</span><span class="p">,</span>
    <span class="s2">"question[asked_at_time]"</span> <span class="o">=&gt;</span> <span class="nv">$now_time</span><span class="p">,</span>
    <span class="s2">"question[asked_at_date]"</span> <span class="o">=&gt;</span> <span class="nv">$now_date</span><span class="p">,</span>
<span class="p">];</span>

<span class="nv">$req</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="nv">$api_url</span><span class="p">);</span>
<span class="nv">$credentials</span> <span class="o">=</span> <span class="s2">"${EMAIL}:${API_KEY}"</span><span class="p">;</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_USERPWD</span><span class="p">,</span> <span class="nv">$credentials</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_POST</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nv">$fields</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$req</span><span class="p">);</span>
<span class="nv">$response_code</span> <span class="o">=</span> <span class="nb">curl_getinfo</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLINFO_RESPONSE_CODE</span><span class="p">);</span>
<span class="c1">// Do what you need with the data</span>
<span class="k">echo</span><span class="p">(</span><span class="s2">"${response_code} ${data}"</span><span class="p">);</span>

<span class="c1">// ?&gt;</span>
</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Created"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint adds a new question.</p>
<h3 id='http-request-3'>HTTP Request</h3>
<p><code>POST https://&lt;DOMAIN&gt;.gimlet.us/api/v1/sites/&lt;SITE_ID&gt;/questions</code></p>
<h3 id='url-parameters'>URL Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>site_id</td>
<td>0</td>
<td>The ID of the brand/site for the new question</td>
</tr>
<tr>
<td>question[location_name]</td>
<td>Reference</td>
<td>The LOCATION facet value</td>
</tr>
<tr>
<td>question[duration_name]</td>
<td>0-5 minutes</td>
<td>The DURATION facet value</td>
</tr>
<tr>
<td>question[format_name]</td>
<td>Phone</td>
<td>The FORMAT facet value</td>
</tr>
<tr>
<td>question[questioner_name]</td>
<td>Staff</td>
<td>The QUESTIONER facet value (aka &quot;Asked by&quot;)</td>
</tr>
<tr>
<td>question[question_type_name]</td>
<td>Technology</td>
<td>The TYPE facet value</td>
</tr>
<tr>
<td>question[difficulty_name]</td>
<td>1</td>
<td>The DIFFICULTY facet value</td>
</tr>
<tr>
<td>question[tag_list]</td>
<td>example_tag</td>
<td>Space separated list of tags (can leave blank)</td>
</tr>
<tr>
<td>question[question]</td>
<td>text</td>
<td>Question text (can leave blank)</td>
</tr>
<tr>
<td>question[answer]</td>
<td>text</td>
<td>Answer text (can leave blank)</td>
</tr>
<tr>
<td>question[initials]</td>
<td>EWL</td>
<td>User Initials value (can leave blank)</td>
</tr>
<tr>
<td>question[asked_at_time]</td>
<td>&quot;04:22 PM&quot;</td>
<td>Time of question</td>
</tr>
<tr>
<td>question[asked_at_date]</td>
<td>&quot;03/24/2021&quot;</td>
<td>Date of question</td>
</tr>
</tbody></table>
<h1 id='branches'>Branches</h1><h2 id='list-branches-json'>List Branches JSON</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'faraday'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="c1">#</span>
<span class="c1"># List all Branches/Sites from an Account</span>
<span class="c1">#</span>

<span class="c1"># Required API Variables</span>
<span class="nb">require</span> <span class="s1">'./vars.rb'</span>

<span class="c1"># URL and Path</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">"https://</span><span class="si">#{</span><span class="no">DOMAIN</span><span class="si">}</span><span class="s2">.gimlet.us"</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">"/api/v1/sites.json"</span>

<span class="c1"># New connection with base URL and path</span>
<span class="n">conn</span> <span class="o">=</span> <span class="no">Faraday</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">url: </span><span class="n">url</span><span class="p">)</span>    <span class="c1"># New connection with base URL</span>
<span class="n">conn</span><span class="p">.</span><span class="nf">basic_auth</span><span class="p">(</span><span class="no">EMAIL</span><span class="p">,</span> <span class="no">API_KEY</span><span class="p">)</span> <span class="c1"># Set the authentication header</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>       <span class="c1"># GET API request</span>

<span class="c1"># Print the results</span>
<span class="n">results</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="nb">puts</span> <span class="s2">"RESULTS: </span><span class="si">#{</span><span class="n">results</span><span class="p">.</span><span class="nf">inspect</span><span class="si">}</span><span class="s2">"</span>
</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'./vars.php'</span><span class="p">;</span>

<span class="nv">$api_url</span> <span class="o">=</span> <span class="s2">"https://</span><span class="si">{</span><span class="nv">$DOMAIN</span><span class="si">}</span><span class="s2">.gimlet.us/api/v1/sites"</span><span class="p">;</span>

<span class="nv">$req</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="nv">$api_url</span><span class="p">);</span>
<span class="nv">$credentials</span> <span class="o">=</span> <span class="s2">"</span><span class="si">{</span><span class="nv">$EMAIL</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="nv">$API_KEY</span><span class="si">}</span><span class="s2">"</span><span class="p">;</span>

<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_USERPWD</span><span class="p">,</span> <span class="nv">$credentials</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$req</span><span class="p">);</span>
<span class="nv">$parsed</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>

<span class="c1">// Do what you need with the data</span>
<span class="nb">var_dump</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
<span class="cp">?&gt;</span>

</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"branches"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Engineering Library"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"help_url"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nl">"question_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">422</span><span class="p">,</span><span class="w">
      </span><span class="nl">"use_initials"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"use_difficulty"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"use_qa"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"use_tagging"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Humanities Library"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"active"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"help_url"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
      </span><span class="nl">"question_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">380</span><span class="p">,</span><span class="w">
      </span><span class="nl">"use_initials"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"use_difficulty"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"use_qa"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"use_tagging"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves all account branches/sites as JSON.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET https://&lt;DOMAIN&gt;.gimlet.us/api/v1/sites.json</code></p>
<h1 id='facets'>Facets</h1><h2 id='list-facets-json'>List Facets JSON</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'faraday'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="c1">#</span>
<span class="c1"># List all Facets from a Branch/Site</span>
<span class="c1">#</span>

<span class="c1"># Required API Variables</span>
<span class="nb">require</span> <span class="s1">'./vars.rb'</span>

<span class="c1"># URL and Path</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">"https://</span><span class="si">#{</span><span class="no">DOMAIN</span><span class="si">}</span><span class="s2">.gimlet.us"</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">"/api/v1/sites/</span><span class="si">#{</span><span class="no">SITE_ID</span><span class="si">}</span><span class="s2">/facets.json"</span>

<span class="c1"># New connection with base URL and path</span>
<span class="n">conn</span> <span class="o">=</span> <span class="no">Faraday</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">url: </span><span class="n">url</span><span class="p">)</span>    <span class="c1"># New connection with base URL</span>
<span class="n">conn</span><span class="p">.</span><span class="nf">basic_auth</span><span class="p">(</span><span class="no">EMAIL</span><span class="p">,</span> <span class="no">API_KEY</span><span class="p">)</span> <span class="c1"># Set the authentication header</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>       <span class="c1"># GET API request</span>

<span class="c1"># Print the results</span>
<span class="n">results</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="nb">puts</span> <span class="s2">"RESULTS: </span><span class="si">#{</span><span class="n">results</span><span class="p">.</span><span class="nf">inspect</span><span class="si">}</span><span class="s2">"</span>

</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'vars.php'</span><span class="p">;</span>

<span class="nv">$api_url</span> <span class="o">=</span> <span class="s2">"https://${DOMAIN}.gimlet.us/api/v1/sites/${SITE_ID}/facets"</span><span class="p">;</span>

<span class="nv">$req</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="nv">$api_url</span><span class="p">);</span>
<span class="nv">$credentials</span> <span class="o">=</span> <span class="s2">"${EMAIL}:${API_KEY}"</span><span class="p">;</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_USERPWD</span><span class="p">,</span> <span class="nv">$credentials</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$req</span><span class="p">);</span>
<span class="nv">$parsed</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>

<span class="c1">// Do what you need with the data</span>
<span class="nb">var_dump</span><span class="p">(</span><span class="nv">$parsed</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"facets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Duration"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0-5 minutes"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="p">,</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Format"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"In person"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">19</span><span class="p">,</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Location"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Reference"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Questioner"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Adult"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"QuestionType"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Directional"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="err">...</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves all account facets as JSON.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET https://&lt;DOMAIN&gt;.gimlet.us/api/v1/facets.json</code></p>
<h1 id='users'>Users</h1><h2 id='list-users-json'>List Users JSON</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'faraday'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="c1">#</span>
<span class="c1"># List all Users within an Account</span>
<span class="c1">#</span>

<span class="c1"># Required API Variables</span>
<span class="nb">require</span> <span class="s1">'./vars.rb'</span>

<span class="c1"># URL and Path</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">"https://</span><span class="si">#{</span><span class="no">DOMAIN</span><span class="si">}</span><span class="s2">.gimlet.us"</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">"/api/v1/users.json"</span>

<span class="c1"># New connection with base URL and path</span>
<span class="n">conn</span> <span class="o">=</span> <span class="no">Faraday</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">url: </span><span class="n">url</span><span class="p">)</span>    <span class="c1"># New connection with base URL</span>
<span class="n">conn</span><span class="p">.</span><span class="nf">basic_auth</span><span class="p">(</span><span class="no">EMAIL</span><span class="p">,</span> <span class="no">API_KEY</span><span class="p">)</span> <span class="c1"># Set the authentication header</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>       <span class="c1"># GET API request</span>

<span class="c1"># Print the results</span>
<span class="n">results</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="nb">puts</span> <span class="s2">"RESULTS: </span><span class="si">#{</span><span class="n">results</span><span class="p">.</span><span class="nf">inspect</span><span class="si">}</span><span class="s2">"</span>

</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'./vars.php'</span><span class="p">;</span>

<span class="nv">$api_url</span> <span class="o">=</span> <span class="s2">"https://</span><span class="si">{</span><span class="nv">$DOMAIN</span><span class="si">}</span><span class="s2">.gimlet.us/api/v1/users"</span><span class="p">;</span>

<span class="nv">$req</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="nv">$api_url</span><span class="p">);</span>
<span class="nv">$credentials</span> <span class="o">=</span> <span class="s2">"</span><span class="si">{</span><span class="nv">$EMAIL</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="nv">$API_KEY</span><span class="si">}</span><span class="s2">"</span><span class="p">;</span>

<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_USERPWD</span><span class="p">,</span> <span class="nv">$credentials</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$req</span><span class="p">);</span>
<span class="nv">$parsed</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>

<span class="c1">// Do what you need with the data</span>
<span class="nb">var_dump</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
<span class="cp">?&gt;</span>

</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"users"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
      </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jane@library.org"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"current_sign_in_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-03-24T10:39:48.000-05:00"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"last_sign_in_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-03-23T13:19:42.000-05:00"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"sites"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="err">...</span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint retrieves all account users as JSON.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET https://&lt;DOMAIN&gt;.gimlet.us/api/v1/users.json</code></p>
<h2 id='add-user'>Add User</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'faraday'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="c1">#</span>
<span class="c1"># Add a User to an Account</span>
<span class="c1">#</span>

<span class="c1"># Required API Variables</span>
<span class="nb">require</span> <span class="s1">'./vars.rb'</span>

<span class="c1"># URL and Path</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">"https://</span><span class="si">#{</span><span class="no">DOMAIN</span><span class="si">}</span><span class="s2">.gimlet.us"</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">"/api/v1/users.json"</span>

<span class="c1"># Example User values</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">params</span><span class="p">[</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">params</span><span class="p">[</span><span class="s1">'user'</span><span class="p">][</span><span class="s1">'email'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'example@library.org'</span> <span class="c1"># New email/user to create</span>
<span class="n">params</span><span class="p">[</span><span class="s1">'user'</span><span class="p">][</span><span class="s1">'site_ids'</span><span class="p">]</span><span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>            <span class="c1"># Your site ids for membership</span>

<span class="c1"># New connection with base URL and path</span>
<span class="n">conn</span> <span class="o">=</span> <span class="no">Faraday</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">url: </span><span class="n">url</span><span class="p">)</span>              <span class="c1"># New connection with base URL</span>
<span class="n">conn</span><span class="p">.</span><span class="nf">basic_auth</span><span class="p">(</span><span class="no">EMAIL</span><span class="p">,</span> <span class="no">API_KEY</span><span class="p">)</span>           <span class="c1"># Set the authentication header</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>        <span class="c1"># POST API request</span>

<span class="c1"># Print the results</span>
<span class="n">results</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="nb">puts</span> <span class="s2">"RESULTS: </span><span class="si">#{</span><span class="n">results</span><span class="p">.</span><span class="nf">inspect</span><span class="si">}</span><span class="s2">"</span>

</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'./vars.php'</span><span class="p">;</span>

<span class="nv">$api_url</span> <span class="o">=</span> <span class="s2">"https://</span><span class="si">{</span><span class="nv">$DOMAIN</span><span class="si">}</span><span class="s2">.gimlet.us/api/v1/users.json"</span><span class="p">;</span>

<span class="c1">// Change these to be what you actually need!</span>
<span class="nv">$fields</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s2">"user[email]=example@library.org"</span><span class="p">,</span>
  <span class="s2">"user[site_ids][]=1"</span><span class="p">,</span>
  <span class="s2">"user[site_ids][]=2"</span>
<span class="p">];</span>

<span class="nv">$req</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="nv">$api_url</span><span class="p">);</span>
<span class="nv">$credentials</span> <span class="o">=</span> <span class="s2">"</span><span class="si">{</span><span class="nv">$EMAIL</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="nv">$API_KEY</span><span class="si">}</span><span class="s2">"</span><span class="p">;</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_USERPWD</span><span class="p">,</span> <span class="nv">$credentials</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_POST</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nb">join</span><span class="p">(</span><span class="nv">$fields</span><span class="p">,</span><span class="s1">'&amp;'</span><span class="p">));</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$req</span><span class="p">);</span>
<span class="nv">$parsed</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>

<span class="c1">// Do what you need with the data</span>
<span class="nb">var_dump</span><span class="p">(</span><span class="nv">$parsed</span><span class="p">);</span>
<span class="c1">// ?&gt;</span>

</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"example@library.org"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"site_ids"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="mi">1</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint adds a new user.</p>
<h3 id='http-request-2'>HTTP Request</h3>
<p><code>POST https://&lt;DOMAIN&gt;.gimlet.us/api/v1/users.json</code></p>
<h3 id='url-parameters'>URL Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>user[email]</td>
<td>example@library.org</td>
<td>The EMAIL for a new user</td>
</tr>
<tr>
<td>user[site_ids]</td>
<td>[1,2]</td>
<td>The Branch/Site IDs for user membership</td>
</tr>
</tbody></table>
<h2 id='update-user'>Update User</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'faraday'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="c1">#</span>
<span class="c1"># Update a User from an Account</span>
<span class="c1">#</span>
<span class="c1"># * Add or remove user site memberships</span>
<span class="c1"># * Update a user's email address</span>
<span class="c1">#</span>

<span class="c1"># Required API Variables</span>
<span class="nb">require</span> <span class="s1">'./vars.rb'</span>

<span class="c1"># Set API method variables</span>
<span class="n">user_id</span> <span class="o">=</span> <span class="mi">1</span>                                  <span class="c1"># User ID to update</span>

<span class="c1"># URL and Path</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">"https://</span><span class="si">#{</span><span class="no">DOMAIN</span><span class="si">}</span><span class="s2">.gimlet.us"</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">"/api/v1/users/</span><span class="si">#{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">.json"</span>

<span class="c1"># Example User values</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">params</span><span class="p">[</span><span class="s1">'user'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">params</span><span class="p">[</span><span class="s1">'user'</span><span class="p">][</span><span class="s1">'email'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'jane_doe@library.org'</span> <span class="c1"># Update user email address</span>
<span class="n">params</span><span class="p">[</span><span class="s1">'user'</span><span class="p">][</span><span class="s1">'site_ids'</span><span class="p">]</span><span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Update site ids for membership /</span>
                                <span class="c1"># Cannot be an empty array</span>

<span class="c1"># New connection with base URL and path</span>
<span class="n">conn</span> <span class="o">=</span> <span class="no">Faraday</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">url: </span><span class="n">url</span><span class="p">)</span>                 <span class="c1"># New connection with base URL</span>
<span class="n">conn</span><span class="p">.</span><span class="nf">basic_auth</span><span class="p">(</span><span class="no">EMAIL</span><span class="p">,</span> <span class="no">API_KEY</span><span class="p">)</span>              <span class="c1"># Set the authentication header</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>            <span class="c1"># PUT API request</span>

<span class="c1"># Print the results</span>
<span class="n">results</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="nb">puts</span> <span class="s2">"RESULTS: </span><span class="si">#{</span><span class="n">results</span><span class="p">.</span><span class="nf">inspect</span><span class="si">}</span><span class="s2">"</span>


</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'./vars.php'</span><span class="p">;</span>

<span class="c1">// Set API method variables</span>
<span class="nv">$user_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// User ID to update</span>

<span class="nv">$api_url</span> <span class="o">=</span> <span class="s2">"https://</span><span class="si">{</span><span class="nv">$DOMAIN</span><span class="si">}</span><span class="s2">.gimlet.us/api/v1/users/</span><span class="si">{</span><span class="nv">$user_id</span><span class="si">}</span><span class="s2">.json"</span><span class="p">;</span>

<span class="c1">// Change these to be what you actually need!</span>
<span class="nv">$fields</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s2">"user[email]=example@library.org"</span><span class="p">,</span>
  <span class="s2">"user[site_ids][]=1"</span><span class="p">,</span>
  <span class="s2">"user[site_ids][]=2"</span>
<span class="p">];</span>

<span class="nv">$req</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="nv">$api_url</span><span class="p">);</span>
<span class="nv">$credentials</span> <span class="o">=</span> <span class="s2">"</span><span class="si">{</span><span class="nv">$EMAIL</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="nv">$API_KEY</span><span class="si">}</span><span class="s2">"</span><span class="p">;</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_USERPWD</span><span class="p">,</span> <span class="nv">$credentials</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_CUSTOMREQUEST</span><span class="p">,</span> <span class="s2">"PUT"</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_POSTFIELDS</span><span class="p">,</span> <span class="nb">join</span><span class="p">(</span><span class="nv">$fields</span><span class="p">,</span><span class="s1">'&amp;'</span><span class="p">));</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$req</span><span class="p">);</span>
<span class="nv">$parsed</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>

<span class="c1">// Do what you need with the data</span>
<span class="nb">var_dump</span><span class="p">(</span><span class="nv">$parsed</span><span class="p">);</span>
<span class="c1">// ?&gt;</span>

</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jane_doe@library.org"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"site_ids"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="mi">1</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint updates an existing user.</p>
<h3 id='http-request-3'>HTTP Request</h3>
<p><code>PUT https://&lt;DOMAIN&gt;.gimlet.us/api/v1/users/&lt;USER_ID&gt;.json</code></p>
<h3 id='url-parameters-2'>URL Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th>Example</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>user[email]</td>
<td>example@library.org</td>
<td>Update the EMAIL for an existing user</td>
</tr>
<tr>
<td>user[site_ids]</td>
<td>[1,2]</td>
<td>Update the Branch/Site IDs for user membership</td>
</tr>
</tbody></table>
<h2 id='delete-user'>Delete User</h2><div class="highlight"><pre class="highlight ruby tab-ruby"><code><span class="nb">require</span> <span class="s1">'faraday'</span>
<span class="nb">require</span> <span class="s1">'json'</span>

<span class="c1">#</span>
<span class="c1"># Delete a User from an Account</span>
<span class="c1">#</span>

<span class="c1"># Required API Variables</span>
<span class="nb">require</span> <span class="s1">'./vars.rb'</span>

<span class="c1"># Set API method variables</span>
<span class="n">user_id</span> <span class="o">=</span> <span class="mi">1</span>                               <span class="c1"># User ID to destroy /</span>
                                          <span class="c1"># You cannot destroy your own account</span>

<span class="c1"># URL and Path</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">"https://</span><span class="si">#{</span><span class="no">DOMAIN</span><span class="si">}</span><span class="s2">.gimlet.us"</span>
<span class="n">path</span> <span class="o">=</span> <span class="s2">"/api/v1/users/</span><span class="si">#{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">.json"</span>

<span class="c1"># New connection with base URL and path</span>
<span class="n">conn</span> <span class="o">=</span> <span class="no">Faraday</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="ss">url: </span><span class="n">url</span><span class="p">)</span>              <span class="c1"># New connection with base URL</span>
<span class="n">conn</span><span class="p">.</span><span class="nf">basic_auth</span><span class="p">(</span><span class="no">EMAIL</span><span class="p">,</span> <span class="no">API_KEY</span><span class="p">)</span>           <span class="c1"># Set the authentication header</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">conn</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>              <span class="c1"># DELETE API request</span>

<span class="c1"># Print the results</span>
<span class="n">results</span> <span class="o">=</span> <span class="no">JSON</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="nb">puts</span> <span class="s2">"RESULTS: </span><span class="si">#{</span><span class="n">results</span><span class="p">.</span><span class="nf">inspect</span><span class="si">}</span><span class="s2">"</span>

</code></pre></div><div class="highlight"><pre class="highlight php tab-php"><code><span class="cp">&lt;?php</span>
<span class="k">require</span> <span class="s1">'./vars.php'</span><span class="p">;</span>

<span class="c1">// Set API method variables</span>
<span class="nv">$user_id</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="c1">// User ID to delete</span>
              <span class="c1">// You cannot destroy your own account</span>

<span class="nv">$api_url</span> <span class="o">=</span> <span class="s2">"https://</span><span class="si">{</span><span class="nv">$DOMAIN</span><span class="si">}</span><span class="s2">.gimlet.us/api/v1/users/</span><span class="si">{</span><span class="nv">$user_id</span><span class="si">}</span><span class="s2">.json"</span><span class="p">;</span>

<span class="nv">$req</span> <span class="o">=</span> <span class="nb">curl_init</span><span class="p">(</span><span class="nv">$api_url</span><span class="p">);</span>
<span class="nv">$credentials</span> <span class="o">=</span> <span class="s2">"</span><span class="si">{</span><span class="nv">$EMAIL</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="nv">$API_KEY</span><span class="si">}</span><span class="s2">"</span><span class="p">;</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_USERPWD</span><span class="p">,</span> <span class="nv">$credentials</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_CUSTOMREQUEST</span><span class="p">,</span> <span class="s2">"DELETE"</span><span class="p">);</span>
<span class="nb">curl_setopt</span><span class="p">(</span><span class="nv">$req</span><span class="p">,</span> <span class="no">CURLOPT_RETURNTRANSFER</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>

<span class="nv">$data</span> <span class="o">=</span> <span class="nb">curl_exec</span><span class="p">(</span><span class="nv">$req</span><span class="p">);</span>

<span class="c1">// Do what you need with the data</span>
<span class="nb">var_dump</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>

<span class="c1">// ?&gt;</span>
</code></pre></div>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="nl">"status"</span><span class="p">:</span><span class="s2">"success"</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>This endpoint deletes a user.</p>
<h3 id='http-request-4'>HTTP Request</h3>
<p><code>DELETE https://&lt;DOMAIN&gt;.gimlet.us/api/v1/users/&lt;USER_ID&gt;.json</code></p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="ruby">ruby</a>
                <a href="#" data-language-name="php">php</a>
          </div>
      </div>
    </div>
  </body>
</html>
